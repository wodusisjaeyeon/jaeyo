<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>동맹 배너 목록</title>
    <style>
        /* 기본 글꼴 및 패딩 설정 */
        body {
            font-family: courier, monospace; /* 글꼴: courier, monospace */
            font-size: 14px; /* 기본 글꼴 크기 */
            padding: 8px; /* 페이지 내부 여백 */
            margin: 0; /* 페이지 외부 여백 없음 */
            padding-bottom: 10rem;
        }
        /* 표 스타일 */
        table {
            width: 100%; /* 표 전체 너비 */
            margin: 0 auto; /* 표 가운데 정렬 */
            border-collapse: collapse; /* 셀 테두리 병합 */
        }
        /* 테이블 헤더(th)와 셀(td)의 기본 스타일 */
        th, td {
            text-align: left; /* 텍스트 왼쪽 정렬 */
            vertical-align: top; /* 내용 상단 정렬 */
            border-bottom: 1px solid #000; /* 하단 테두리 */
            padding: 0; /* 기본 패딩 없음 */
        }
        
        /* 표 행에 마우스를 올렸을 때 배경색 변경 */
        tr:hover {
            background-color: #fff000; /* 노란색 배경 */
        }
        
        /* 테이블 헤더 스타일 */
        th {
            font-weight: bold; /* 글꼴 굵게 */
            font-size: 0.75rem; /* 글꼴 크기 */
            padding-left: 8px; /* 왼쪽 패딩 */
            padding-bottom: 4px; /* 하단 패딩 */
        }
        /* 일반 셀의 최소 너비 */
        td {
            min-width: 90px;
            width: auto;
        }
        /* 배너 셀 스타일 */
        td.banner-cell {
            width: 90px; /* 배너 셀 너비 고정 */
            height: 30px; /* 배너 셀 높이 고정 */
            text-align: center; /* 배너 이미지 가운데 정렬 */
            overflow: hidden; /* 상자 밖으로 나가는 이미지 숨김 */
        }
        /* 배너 이미지 스타일 */
        td.banner-cell img {
            width: 90px; /* GIF 배너 너비 90px로 고정 */
            height: 30px; /* GIF 배너 높이 30px로 고정 */
            object-fit: cover; /* 이미지가 상자를 꽉 채우도록 하되, 비율 유지하며 필요시 잘림 */
            display: block; /* 블록 요소로 만들어 마진 auto 적용 가능하게 함 */
            margin: 0 auto; /* 가로 가운데 정렬 */
        }

        /* Removed .homepage-cell styles as the column is gone */
        /* '홈피 주인' 셀 스타일 */
        td.owner-cell {
            padding-left: 8px;
            padding-top: 7px;
        }
        /* '주제' 셀 스타일 */
        td.topic-cell {
            padding-left: 8px;
            padding-top: 7px;
        }
        /* '소개글' 셀 스타일 */
        td.description-cell {
            padding-left: 8px;
            padding-top: 7px;
        }

        /* --- 모바일 반응형 스타일 (Max-width 768px 이하) --- */
        @media (max-width: 500px) { /* 768px 이하 화면에 적용 */
            table {
                border-collapse: separate; /* 테이블 셀 병합 해제 */
                border-spacing: 0; /* 각 '카드' 사이의 간격 (세로) */
                padding-bottom: 2rem;
            }

            thead {
                display: none; /* 모바일에서는 테이블 헤더 숨기기 (셀이 쌓이므로 의미 없음) */
            }

            tr {
                display: flex; /* 각 행을 Flexbox 컨테이너로 만듭니다 */
                flex-wrap: wrap; /* 내용이 넘치면 다음 줄로 이동합니다 */
                border-top: 1px solid #000; /* 각 동맹 항목에 테두리 추가하여 시각적으로 구분 */
                margin-bottom: 0; /* 기존 tr 하단 마진 제거 */
            }
            
            th, td {
                display: block; /* 모든 셀을 블록 레벨 요소로 만듭니다 (기본적으로 세로로 쌓임) */
                width: auto; /* 너비 자동 조절 */
            }

            td.banner-cell {
                width: 90px; /* 배너 이미지 너비 유지 */
                height: 30px;
                flex-shrink: 0; /* 공간이 부족해도 줄어들지 않음 */
                padding-right: 0.5rem;
            }

            td.owner-cell,
            td.topic-cell {
                display: none;
            }

            td.description-cell {
                flex-grow: 1; /* 소개글 셀이 항상 전체 너비를 차지하여 다음 줄로 이동 */
                padding: 0.4rem 0;
            }
        }
    </style>
</head>
<body>
    <div style="display: flex; gap: 2rem; padding-bottom: 2rem; font-size: 0.8rem;">
    <p><a href="https://docs.google.com/document/d/14Z3Jt_uYfgDts8DDEqMbB1hn93Nu_l0-F7JoXHx-2_s" target="_blank">홈피 만드는 법</a></p>
    <p><a href="https://tally.so/r/n0YBxy" target="_blank">동맹 신청</a></p></div>
    
    <table id="bannerTable">
        <thead>
            <tr>
                <th class="banner-cell"></th> <th class="owner-cell">홈피 주인</th>
                <th class="topic-cell">주제</th>
                <th class="description-cell">소개글</th>
            </tr>
        </thead>
        <tbody>
            </tbody>
    </table>

    <script>
        // Google Sheet의 CSV 게시 URL: 여기에 데이터를 가져올 Google 스프레드시트의 CSV URL을 입력합니다.
        // 이 URL은 스프레드시트에서 "파일 > 공유 > 웹에 게시"를 통해 얻을 수 있습니다.
        const CSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRslE5ib8k-r5LiiYEuAKvv2_Nk93tQqQFTkTIW_dpVf-rjdu3hE6JgclEdHI_I804PxLFxU4ckToIu/pub?output=csv';

        // 데이터를 불러오는 비동기 함수
        async function loadData() {








            try {
                // CSV URL에서 데이터 가져오기
                const response = await fetch(CSV_URL);
                // 응답이 성공적인지 확인
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                // 응답을 텍스트(CSV)로 변환
                const csvText = await response.text();
                // CSV 텍스트를 파싱하여 테이블에 표시
                parseCSV(csvText);
            } catch (error) {
                // 데이터 로드 실패 시 오류 메시지 출력
                console.error('데이터를 불러오는 중 오류 발생:', error);
                document.getElementById('bannerTable').innerHTML = '<tr><td colspan="4">데이터 로드 실패. URL을 확인하거나 네트워크 상태를 확인하세요.</td></tr>';


            }
        }

        // CSV 텍스트를 파싱하여 HTML 테이블에 표시하는 함수
        function parseCSV(csv) {
            // CSV 텍스트를 줄 단위로 분리하고, 비어있는 줄은 제거합니다.
            const lines = csv.split('\n').filter(line => line.trim() !== '');
            // 첫 줄(헤더)을 제외한 데이터 행들을 가져옵니다.
            const dataRows = lines.slice(1); 

            // 테이블의 tbody 요소를 가져옵니다.
            const tbody = document.querySelector('#bannerTable tbody');
            tbody.innerHTML = ''; // 기존 내용을 초기화합니다.

            // 각 데이터 행을 순회하며 처리합니다.
            dataRows.forEach(row => {
                // 쉼표로 값을 분리하고, 따옴표로 묶인 쉼표는 무시합니다. (예: "a,b"는 하나의 값)
                // 값 앞뒤의 공백을 제거하고, 따옴표를 제거합니다.
                const values = row.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/).map(value => value.trim().replace(/^"|"$/g, ''));

                // 필요한 최소한의 열(5개)이 있는지 확인합니다.
                if (!values || values.length < 5) return; 

                // CSV 열 순서에 따라 값을 할당합니다.
                const bannerGifUrl = values[0]; // 배너 GIF URL (A열)
                const homepageUrl = values[1]; // 홈피 URL (B열, 현재 사용하지 않음)
                const homepageOwner = values[2]; // 홈피 주인 (C열)
                const topic = values[3]; // 주제 (D열)
                const description = values[4]; // 소개글 (E열)

                // 새로운 테이블 행(tr)을 생성합니다.
                const tr = document.createElement('tr');

                // 홈피 URL이 있다면 전체 행을 클릭 가능하게 만듭니다.
                if (homepageUrl) {
                    tr.style.cursor = 'pointer'; // 마우스 커서를 포인터로 변경하여 클릭 가능함을 나타냄
                    tr.onclick = () => {
                        window.open(homepageUrl, '_blank'); // 새 탭에서 홈피 URL 열기
                    };
                }
                // 1. 배너 GIF 셀 (A열)
                const bannerTd = document.createElement('td');
                bannerTd.classList.add('banner-cell');
                if (bannerGifUrl) {
                    const img = document.createElement('img');
                    img.src = bannerGifUrl; // 이미지 소스 설정
                    img.alt = '배너 GIF'; // 이미지 대체 텍스트
                    bannerTd.appendChild(img); // 셀에 이미지 추가
                } else {
                    bannerTd.textContent = '이미지 없음'; // 이미지가 없으면 텍스트 표시
                }
                tr.appendChild(bannerTd); // 행에 배너 셀 추가

                // 2. 홈피 주인 셀 (C열)
                const ownerTd = document.createElement('td');
                ownerTd.classList.add('owner-cell');
                ownerTd.textContent = homepageOwner || '-'; // 값이 없으면 '-' 표시
                tr.appendChild(ownerTd); // 행에 홈피 주인 셀 추가

                // 3. 주제 셀 (D열)
                const topicTd = document.createElement('td');
                topicTd.classList.add('topic-cell');
                topicTd.textContent = topic || '-'; // 값이 없으면 '-' 표시
                tr.appendChild(topicTd); // 행에 주제 셀 추가

                // 4. 소개글 셀 (E열)
                const descriptionTd = document.createElement('td');
                descriptionTd.classList.add('description-cell');
                descriptionTd.textContent = description || '-'; // 값이 없으면 '-' 표시
                tr.appendChild(descriptionTd); // 행에 소개글 셀 추가

                tbody.appendChild(tr); // tbody에 완성된 행 추가
            });
        }

        // 페이지 로드 시 데이터 불러오기 함수 호출
        document.addEventListener('DOMContentLoaded', loadData);

    </script>

</body>
</html>